import { __assign, __read, __spread } from "tslib";
// WORKAROUND: https://github.com/dherges/ng-packagr/issues/217#issuecomment-339460255
import * as momentImported from 'moment';
var moment = momentImported;
export var DAYS_OF_WEEK;
(function (DAYS_OF_WEEK) {
    DAYS_OF_WEEK[DAYS_OF_WEEK["SUNDAY"] = 0] = "SUNDAY";
    DAYS_OF_WEEK[DAYS_OF_WEEK["MONDAY"] = 1] = "MONDAY";
    DAYS_OF_WEEK[DAYS_OF_WEEK["TUESDAY"] = 2] = "TUESDAY";
    DAYS_OF_WEEK[DAYS_OF_WEEK["WEDNESDAY"] = 3] = "WEDNESDAY";
    DAYS_OF_WEEK[DAYS_OF_WEEK["THURSDAY"] = 4] = "THURSDAY";
    DAYS_OF_WEEK[DAYS_OF_WEEK["FRIDAY"] = 5] = "FRIDAY";
    DAYS_OF_WEEK[DAYS_OF_WEEK["SATURDAY"] = 6] = "SATURDAY";
})(DAYS_OF_WEEK || (DAYS_OF_WEEK = {}));
var DEFAULT_WEEKEND_DAYS = [
    DAYS_OF_WEEK.SUNDAY,
    DAYS_OF_WEEK.SATURDAY
];
export var DAYS_IN_WEEK = 7;
export var HOURS_IN_DAY = 24;
export var MINUTES_IN_HOUR = 60;
export var SECONDS_IN_DAY = 60 * 60 * 24;
export var DEFAULT_HOUR_SEGMENT_HEIGHT_PX = 40;
export var DEFAULT_EVENT_WIDTH = 1;
export var DEFAULT_HOUR_SEGMENTS = 2;
export function getSchedulerViewHourGrid(dateAdapter, _a) {
    var viewDate = _a.viewDate, hourSegments = _a.hourSegments, dayStart = _a.dayStart, dayEnd = _a.dayEnd;
    var setMinutes = dateAdapter.setMinutes, setHours = dateAdapter.setHours, startOfDay = dateAdapter.startOfDay, startOfMinute = dateAdapter.startOfMinute, endOfDay = dateAdapter.endOfDay, addMinutes = dateAdapter.addMinutes, addHours = dateAdapter.addHours, addDays = dateAdapter.addDays;
    var hours = [];
    var startOfView = setMinutes(setHours(startOfDay(viewDate), sanitiseHours(dayStart.hour)), sanitiseMinutes(dayStart.minute));
    var endOfView = setMinutes(setHours(startOfMinute(endOfDay(viewDate)), sanitiseHours(dayEnd.hour)), sanitiseMinutes(dayEnd.minute));
    var segmentDuration = MINUTES_IN_HOUR / hourSegments;
    var startOfViewDay = startOfDay(viewDate);
    var endOfViewDay = endOfDay(viewDate);
    var dateAdjustment = function (d) { return d; };
    // this means that we change from or to DST on this day and that's going to cause problems so we bump the date
    if (startOfViewDay.getTimezoneOffset() !== endOfViewDay.getTimezoneOffset()) {
        startOfViewDay = addDays(startOfViewDay, 1);
        startOfView = addDays(startOfView, 1);
        endOfView = addDays(endOfView, 1);
        dateAdjustment = function (d) { return addDays(d, -1); };
    }
    for (var i = 0; i < HOURS_IN_DAY; i++) {
    }
    for (var i = 0; i < HOURS_IN_DAY; i++) {
        var segments = [];
        for (var j = 0; j < hourSegments; j++) {
            var date = addMinutes(addHours(startOfViewDay, i), j * segmentDuration);
            if (date >= startOfView && date < endOfView) {
                segments.push({
                    date: dateAdjustment(date),
                    displayDate: date,
                    isStart: j === 0
                });
            }
        }
        if (segments.length > 0) {
            hours.push({ segments: segments });
        }
    }
    return hours;
}
export function getSchedulerView(dateAdapter, _a) {
    var _b = _a.events, events = _b === void 0 ? [] : _b, viewDate = _a.viewDate, viewDays = _a.viewDays, weekStartsOn = _a.weekStartsOn, startsWithToday = _a.startsWithToday, _c = _a.excluded, excluded = _c === void 0 ? [] : _c, _d = _a.hourSegments, hourSegments = _d === void 0 ? DEFAULT_HOUR_SEGMENTS : _d, dayStart = _a.dayStart, dayEnd = _a.dayEnd, _e = _a.weekendDays, weekendDays = _e === void 0 ? DEFAULT_WEEKEND_DAYS : _e, _f = _a.hourSegmentHeight, hourSegmentHeight = _f === void 0 ? DEFAULT_HOUR_SEGMENT_HEIGHT_PX : _f, _g = _a.eventWidth, eventWidth = _g === void 0 ? DEFAULT_EVENT_WIDTH : _g, logEnabled = _a.logEnabled;
    if (!events) {
        events = [];
    }
    var addDays = dateAdapter.addDays, startOfDay = dateAdapter.startOfDay, endOfDay = dateAdapter.endOfDay, startOfWeek = dateAdapter.startOfWeek, endOfWeek = dateAdapter.endOfWeek;
    var startOfViewWeek = startsWithToday || viewDays < DAYS_IN_WEEK ? startOfDay(viewDate) : startOfWeek(viewDate, { weekStartsOn: weekStartsOn });
    var endOfViewWeek = startsWithToday || viewDays < DAYS_IN_WEEK ? addDays(endOfDay(viewDate), viewDays - 1) : endOfWeek(viewDate, { weekStartsOn: weekStartsOn });
    var eventsInWeek = getEventsInPeriod(dateAdapter, {
        events: events,
        periodStart: startOfViewWeek,
        periodEnd: endOfViewWeek
    });
    var days = getSchedulerViewDays(dateAdapter, {
        viewDate: viewDate,
        viewDays: viewDays,
        weekStartsOn: weekStartsOn,
        startsWithToday: startsWithToday,
        excluded: excluded,
        weekendDays: weekendDays
    });
    days.forEach(function (day) {
        var startOfView = dateAdapter.setMinutes(dateAdapter.setHours(dateAdapter.startOfDay(day.date), dayStart.hour), dayStart.minute);
        var endOfView = dateAdapter.setMinutes(dateAdapter.setHours(dateAdapter.startOfMinute(dateAdapter.endOfDay(day.date)), dayEnd.hour), dayEnd.minute);
        var previousDayEvents = [];
        var eventsInDay = getEventsInPeriod(dateAdapter, {
            events: eventsInWeek,
            periodStart: startOfView,
            periodEnd: endOfView
        });
        var dayEvents = eventsInDay
            .sort(function (eventA, eventB) { return eventA.start.valueOf() - eventB.start.valueOf(); })
            .map(function (ev) {
            var eventStart = ev.start;
            var eventEnd = ev.end || eventStart;
            var startsBeforeDay = eventStart < startOfView;
            var endsAfterDay = dateAdapter.addMinutes(eventEnd, -1) > endOfView;
            var hourHeightModifier = ((hourSegments * hourSegmentHeight) + 1) / MINUTES_IN_HOUR; // +1 for the 1px segment bottom border
            var top = 0;
            if (eventStart > startOfView) {
                top += dateAdapter.differenceInMinutes(eventStart, startOfView);
            }
            top *= hourHeightModifier;
            var startDate = startsBeforeDay ? startOfView : eventStart;
            var endDate = endsAfterDay ? endOfView : eventEnd;
            var height = dateAdapter.differenceInMinutes(endDate, startDate);
            if (!ev.end) {
                height = hourSegmentHeight;
            }
            else {
                height *= hourHeightModifier;
            }
            var bottom = top + height;
            var overlappingPreviousEvents = getOverLappingEvents(ev, previousDayEvents, top, bottom, logEnabled);
            var left = 0;
            while (overlappingPreviousEvents.some(function (previousEvent) { return previousEvent.left === left; })) {
                left += eventWidth;
            }
            var event = {
                event: ev,
                top: top,
                height: height,
                width: eventWidth,
                left: left,
                startsBeforeDay: startsBeforeDay,
                endsAfterDay: endsAfterDay
            };
            previousDayEvents.push(event);
            return event;
        });
        function getColumnCount(allEvents, prevOverlappingEvents) {
            var columnCount = Math.max.apply(Math, __spread(prevOverlappingEvents.map(function (ev) { return ev.left + 1; })));
            var nextOverlappingEvents = allEvents
                .filter(function (ev) { return ev.left >= columnCount; })
                .filter(function (ev) {
                return (getOverLappingEvents(ev, prevOverlappingEvents, ev.top, ev.top + ev.height, logEnabled).length > 0);
            });
            if (nextOverlappingEvents.length > 0) {
                return getColumnCount(allEvents, nextOverlappingEvents);
            }
            else {
                return columnCount;
            }
        }
        var mappedEvents = dayEvents.map(function (event) {
            var columnCount = getColumnCount(dayEvents, getOverLappingEvents(event, dayEvents, event.top, event.top + event.height, logEnabled));
            var width = 100 / columnCount;
            return __assign(__assign({}, event), { left: event.left * width, width: width });
        });
        day.events = mappedEvents.map(function (event) {
            var overLappingEvents = getOverLappingEvents(event, mappedEvents.filter(function (otherEvent) { return otherEvent.left > event.left; }), event.top, event.top + event.height, logEnabled);
            if (logEnabled) {
                console.log("DAY [" + moment(day.date).format('dddd L') + "] " +
                    ("- EVENT " + event.event.id + " [" + moment(event.event.start).format('dddd L, LTS') + " ") +
                    ("- " + moment(event.event.end).format('dddd L, LTS') + "] overLappingEvents -> "), overLappingEvents);
            }
            if (overLappingEvents.length > 0) {
                return __assign(__assign({}, event), { width: Math.min.apply(Math, __spread(overLappingEvents.map(function (otherEvent) { return otherEvent.left; }))) - event.left });
            }
            return event;
        });
        day.hours = getSchedulerViewHourGrid(dateAdapter, {
            viewDate: viewDate,
            hourSegments: hourSegments,
            dayStart: {
                hour: dayStart.hour,
                minute: dayStart.minute
            },
            dayEnd: {
                hour: dayEnd.hour,
                minute: dayEnd.minute
            }
        }).map(function (hour) {
            var date = new Date(day.date.getFullYear(), day.date.getMonth(), day.date.getDate(), hour.segments[0].date.getHours());
            var startOfHour = new Date(day.date.getFullYear(), day.date.getMonth(), day.date.getDate(), hour.segments[0].date.getHours());
            var endOfHour = dateAdapter.addSeconds(dateAdapter.addHours(startOfHour, 1), -1);
            var eventsInHour = getSchedulerEventsInPeriod(dateAdapter, {
                events: day.events,
                periodStart: startOfHour,
                periodEnd: endOfHour
            });
            var segments = hour.segments.map(function (segment) {
                segment.date = dateAdapter.setDate(dateAdapter.setMonth(dateAdapter.setYear(segment.date, day.date.getFullYear()), day.date.getMonth()), day.date.getDate());
                var startOfSegment = segment.date;
                var endOfSegment = dateAdapter.addSeconds(dateAdapter.addMinutes(startOfSegment, MINUTES_IN_HOUR / hourSegments), -1);
                var eventsInSegment = getSchedulerEventsInPeriod(dateAdapter, {
                    events: eventsInHour,
                    periodStart: startOfSegment,
                    periodEnd: endOfSegment
                });
                if (logEnabled) {
                    console.log("SEGMENT [" + moment(startOfSegment).format('dddd L, LTS') + " - " + moment(endOfSegment).format('dddd L, LTS') + "] EVENTS -> ", eventsInSegment);
                }
                return {
                    segment: segment,
                    date: new Date(segment.date),
                    events: eventsInSegment
                };
            });
            return {
                hour: hour,
                date: date,
                events: eventsInHour,
                segments: segments
            };
        });
    });
    return {
        days: days,
        period: {
            events: eventsInWeek,
            start: startOfViewWeek,
            end: endOfViewWeek
        }
    };
}
export function getSchedulerViewDays(dateAdapter, _a) {
    var viewDate = _a.viewDate, viewDays = _a.viewDays, weekStartsOn = _a.weekStartsOn, startsWithToday = _a.startsWithToday, _b = _a.excluded, excluded = _b === void 0 ? [] : _b, _c = _a.weekendDays, weekendDays = _c === void 0 ? DEFAULT_WEEKEND_DAYS : _c;
    var start = startsWithToday || viewDays < DAYS_IN_WEEK
        ? new Date(viewDate)
        : dateAdapter.startOfWeek(viewDate, { weekStartsOn: weekStartsOn });
    var days = [];
    var loop = function (i) {
        var date = dateAdapter.addDays(start, i);
        if (!excluded.some(function (e) { return date.getDay() === e; })) {
            days.push(getSchedulerDay(dateAdapter, { date: date, weekendDays: weekendDays }));
        }
    };
    for (var i = 0; i < viewDays; i++) {
        loop(i);
    }
    return days;
}
function getSchedulerDay(dateAdapter, args) {
    var date = args.date;
    var today = dateAdapter.startOfDay(new Date());
    return {
        date: date,
        isPast: date < today,
        isToday: dateAdapter.isSameDay(date, today),
        isFuture: date >= dateAdapter.addDays(today, 1),
        isWeekend: args.weekendDays.indexOf(dateAdapter.getDay(date)) > -1,
        inMonth: dateAdapter.isSameMonth(date, today),
        hours: []
    };
}
function getEventsInPeriod(dateAdapter, _a) {
    var events = _a.events, periodStart = _a.periodStart, periodEnd = _a.periodEnd;
    return events.filter(function (event) { return isEventInPeriod(dateAdapter, { event: event, periodStart: periodStart, periodEnd: periodEnd }); });
}
function getSchedulerEventsInPeriod(dateAdapter, _a) {
    var events = _a.events, periodStart = _a.periodStart, periodEnd = _a.periodEnd;
    return events.filter(function (event) { return isEventInPeriod(dateAdapter, { event: event.event, periodStart: periodStart, periodEnd: periodEnd }); });
}
function isEventInPeriod(dateAdapter, _a) {
    var event = _a.event, periodStart = _a.periodStart, periodEnd = _a.periodEnd;
    var isSameSecond = dateAdapter.isSameSecond, addSeconds = dateAdapter.addSeconds;
    var eventStart = event.start;
    var eventEnd = event.end || event.start;
    if (eventStart > periodStart && eventStart < periodEnd) {
        return true;
    }
    if (eventEnd > periodStart && eventEnd < periodEnd) {
        return true;
    }
    if (eventStart < periodStart && eventEnd > periodEnd) {
        return true;
    }
    if (isSameSecond(eventStart, periodStart) || isSameSecond(eventStart, periodEnd)) {
        return true;
    }
    if (isSameSecond(addSeconds(eventEnd, -1), periodStart) || isSameSecond(addSeconds(eventEnd, -1), periodEnd)) {
        return true;
    }
    return false;
}
function getOverLappingEvents(event /*SchedulerViewEvent | CalendarSchedulerEvent*/, events, top, bottom, logEnabled) {
    if (logEnabled === void 0) { logEnabled = false; }
    return events.filter(function (previousEvent) {
        var _a, _b, _c;
        top = Math.round(top);
        bottom = Math.round(bottom);
        var previousEventTop = Math.floor(previousEvent.top);
        var previousEventBottom = Math.floor(previousEvent.top + previousEvent.height);
        if (top < previousEventBottom && previousEventBottom < bottom) {
            if (logEnabled) {
                console.log('[getOverLappingEvents] - EVENT ' + (((_a = event.event) === null || _a === void 0 ? void 0 : _a.id) || event.id) + ' -> top: ' + top + ' - bottom: ' + bottom + ' | PREVIOUS EVENT ' + previousEvent.event.id
                    + ' -> previousEventTop: ' + previousEventTop + ' - previousEventBottom: ' + previousEventBottom + ' -> top < previousEventBottom && previousEventBottom < bottom');
            }
            return true;
        }
        else if (top < previousEventTop && previousEventTop < bottom) {
            if (logEnabled) {
                console.log('[getOverLappingEvents] - EVENT ' + (((_b = event.event) === null || _b === void 0 ? void 0 : _b.id) || event.id) + ' -> top: ' + top + ' - bottom: ' + bottom + ' | PREVIOUS EVENT ' + previousEvent.event.id
                    + ' -> previousEventTop: ' + previousEventTop + ' - previousEventBottom: ' + previousEventBottom + ' -> top < previousEventTop && previousEventTop < bottom');
            }
            return true;
        }
        else if (previousEventTop <= top && bottom <= previousEventBottom) {
            if (logEnabled) {
                console.log('[getOverLappingEvents] - EVENT ' + (((_c = event.event) === null || _c === void 0 ? void 0 : _c.id) || event.id) + ' -> top: ' + top + ' - bottom: ' + bottom + ' | PREVIOUS EVENT ' + previousEvent.event.id
                    + ' -> previousEventTop: ' + previousEventTop + ' - previousEventBottom: ' + previousEventBottom + ' -> previousEventTop <= top && bottom <= previousEventBottom');
            }
            return true;
        }
        return false;
    });
}
function sanitiseHours(hours) {
    return Math.max(Math.min(23, hours), 0);
}
function sanitiseMinutes(minutes) {
    return Math.max(Math.min(59, minutes), 0);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItc2NoZWR1bGVyLXV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW5ndWxhci1jYWxlbmRhci1zY2hlZHVsZXIvIiwic291cmNlcyI6WyJtb2R1bGVzL3NjaGVkdWxlci91dGlscy9jYWxlbmRhci1zY2hlZHVsZXItdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQWVBLHNGQUFzRjtBQUN0RixPQUFPLEtBQUssY0FBYyxNQUFNLFFBQVEsQ0FBQztBQUN6QyxJQUFNLE1BQU0sR0FBRyxjQUFjLENBQUM7QUFHOUIsTUFBTSxDQUFOLElBQVksWUFRWDtBQVJELFdBQVksWUFBWTtJQUNwQixtREFBVSxDQUFBO0lBQ1YsbURBQVUsQ0FBQTtJQUNWLHFEQUFXLENBQUE7SUFDWCx5REFBYSxDQUFBO0lBQ2IsdURBQVksQ0FBQTtJQUNaLG1EQUFVLENBQUE7SUFDVix1REFBWSxDQUFBO0FBQ2hCLENBQUMsRUFSVyxZQUFZLEtBQVosWUFBWSxRQVF2QjtBQUVELElBQU0sb0JBQW9CLEdBQWE7SUFDbkMsWUFBWSxDQUFDLE1BQU07SUFDbkIsWUFBWSxDQUFDLFFBQVE7Q0FDeEIsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLFlBQVksR0FBVyxDQUFDLENBQUM7QUFDdEMsTUFBTSxDQUFDLElBQU0sWUFBWSxHQUFXLEVBQUUsQ0FBQztBQUN2QyxNQUFNLENBQUMsSUFBTSxlQUFlLEdBQVcsRUFBRSxDQUFDO0FBQzFDLE1BQU0sQ0FBQyxJQUFNLGNBQWMsR0FBVyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQztBQUVuRCxNQUFNLENBQUMsSUFBTSw4QkFBOEIsR0FBRyxFQUFFLENBQUM7QUFDakQsTUFBTSxDQUFDLElBQU0sbUJBQW1CLEdBQUcsQ0FBQyxDQUFDO0FBQ3JDLE1BQU0sQ0FBQyxJQUFNLHFCQUFxQixHQUFHLENBQUMsQ0FBQztBQWN2QyxNQUFNLFVBQVUsd0JBQXdCLENBQ3BDLFdBQXdCLEVBQ3hCLEVBSytCO1FBSjNCLFFB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QUcsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDOUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDYWxlbmRhclNjaGVkdWxlckV2ZW50LFxyXG4gICAgU2NoZWR1bGVyVmlld0hvdXIsXHJcbiAgICBTY2hlZHVsZXJWaWV3RGF5LFxyXG4gICAgU2NoZWR1bGVyVmlld0V2ZW50LFxyXG4gICAgU2NoZWR1bGVyVmlld0hvdXJTZWdtZW50LFxyXG4gICAgU2NoZWR1bGVyVmlldyxcclxuICAgIFNjaGVkdWxlclZpZXdQZXJpb2RcclxufSBmcm9tICcuLi9tb2RlbHMnO1xyXG5pbXBvcnQge1xyXG4gICAgV2Vla1ZpZXdIb3VyLFxyXG4gICAgV2Vla1ZpZXdIb3VyU2VnbWVudFxyXG59IGZyb20gJ2NhbGVuZGFyLXV0aWxzJztcclxuaW1wb3J0IHsgRGF0ZUFkYXB0ZXIgfSBmcm9tICdhbmd1bGFyLWNhbGVuZGFyJztcclxuXHJcbi8vIFdPUktBUk9VTkQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9kaGVyZ2VzL25nLXBhY2thZ3IvaXNzdWVzLzIxNyNpc3N1ZWNvbW1lbnQtMzM5NDYwMjU1XHJcbmltcG9ydCAqIGFzIG1vbWVudEltcG9ydGVkIGZyb20gJ21vbWVudCc7XHJcbmNvbnN0IG1vbWVudCA9IG1vbWVudEltcG9ydGVkO1xyXG5cclxuXHJcbmV4cG9ydCBlbnVtIERBWVNfT0ZfV0VFSyB7XHJcbiAgICBTVU5EQVkgPSAwLFxyXG4gICAgTU9OREFZID0gMSxcclxuICAgIFRVRVNEQVkgPSAyLFxyXG4gICAgV0VETkVTREFZID0gMyxcclxuICAgIFRIVVJTREFZID0gNCxcclxuICAgIEZSSURBWSA9IDUsXHJcbiAgICBTQVRVUkRBWSA9IDZcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9XRUVLRU5EX0RBWVM6IG51bWJlcltdID0gW1xyXG4gICAgREFZU19PRl9XRUVLLlNVTkRBWSxcclxuICAgIERBWVNfT0ZfV0VFSy5TQVRVUkRBWVxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IERBWVNfSU5fV0VFSzogbnVtYmVyID0gNztcclxuZXhwb3J0IGNvbnN0IEhPVVJTX0lOX0RBWTogbnVtYmVyID0gMjQ7XHJcbmV4cG9ydCBjb25zdCBNSU5VVEVTX0lOX0hPVVI6IG51bWJlciA9IDYwO1xyXG5leHBvcnQgY29uc3QgU0VDT05EU19JTl9EQVk6IG51bWJlciA9IDYwICogNjAgKiAyNDtcclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX0hPVVJfU0VHTUVOVF9IRUlHSFRfUFggPSA0MDtcclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRVZFTlRfV0lEVEggPSAxO1xyXG5leHBvcnQgY29uc3QgREVGQVVMVF9IT1VSX1NFR01FTlRTID0gMjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGltZSB7XHJcbiAgICBob3VyOiBudW1iZXI7XHJcbiAgICBtaW51dGU6IG51bWJlcjtcclxuICB9XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEdldFNjaGVkdWxlclZpZXdIb3VyR3JpZEFyZ3Mge1xyXG4gICAgdmlld0RhdGU6IERhdGU7XHJcbiAgICBob3VyU2VnbWVudHM6IG51bWJlcjtcclxuICAgIGRheVN0YXJ0OiBUaW1lO1xyXG4gICAgZGF5RW5kOiBUaW1lO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2NoZWR1bGVyVmlld0hvdXJHcmlkKFxyXG4gICAgZGF0ZUFkYXB0ZXI6IERhdGVBZGFwdGVyLFxyXG4gICAge1xyXG4gICAgICAgIHZpZXdEYXRlLFxyXG4gICAgICAgIGhvdXJTZWdtZW50cyxcclxuICAgICAgICBkYXlTdGFydCxcclxuICAgICAgICBkYXlFbmRcclxuICAgIH06IEdldFNjaGVkdWxlclZpZXdIb3VyR3JpZEFyZ3NcclxuKTogV2Vla1ZpZXdIb3VyW10ge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICAgIHNldE1pbnV0ZXMsXHJcbiAgICAgICAgc2V0SG91cnMsXHJcbiAgICAgICAgc3RhcnRPZkRheSxcclxuICAgICAgICBzdGFydE9mTWludXRlLFxyXG4gICAgICAgIGVuZE9mRGF5LFxyXG4gICAgICAgIGFkZE1pbnV0ZXMsXHJcbiAgICAgICAgYWRkSG91cnMsXHJcbiAgICAgICAgYWRkRGF5c1xyXG4gICAgICB9ID0gZGF0ZUFkYXB0ZXI7XHJcbiAgICBjb25zdCBob3VyczogV2Vla1ZpZXdIb3VyW10gPSBbXTtcclxuXHJcbiAgICBsZXQgc3RhcnRPZlZpZXc6IERhdGUgPSBzZXRNaW51dGVzKFxyXG4gICAgICAgIHNldEhvdXJzKHN0YXJ0T2ZEYXkodmlld0RhdGUpLCBzYW5pdGlzZUhvdXJzKGRheVN0YXJ0LmhvdXIpKSxcclxuICAgICAgICBzYW5pdGlzZU1pbnV0ZXMoZGF5U3RhcnQubWludXRlKVxyXG4gICAgKTtcclxuICAgIGxldCBlbmRPZlZpZXc6IERhdGUgPSBzZXRNaW51dGVzKFxyXG4gICAgICAgIHNldEhvdXJzKHN0YXJ0T2ZNaW51dGUoZW5kT2ZEYXkodmlld0RhdGUpKSwgc2FuaXRpc2VIb3VycyhkYXlFbmQuaG91cikpLFxyXG4gICAgICAgIHNhbml0aXNlTWludXRlcyhkYXlFbmQubWludXRlKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHNlZ21lbnREdXJhdGlvbjogbnVtYmVyID0gTUlOVVRFU19JTl9IT1VSIC8gaG91clNlZ21lbnRzO1xyXG4gICAgbGV0IHN0YXJ0T2ZWaWV3RGF5OiBEYXRlID0gc3RhcnRPZkRheSh2aWV3RGF0ZSk7XHJcbiAgICBjb25zdCBlbmRPZlZpZXdEYXk6IERhdGUgPSBlbmRPZkRheSh2aWV3RGF0ZSk7XHJcbiAgICBsZXQgZGF0ZUFkanVzdG1lbnQ6IChkOiBEYXRlKSA9PiBEYXRlID0gKGQ6IERhdGUpID0+IGQ7XHJcblxyXG4gICAgLy8gdGhpcyBtZWFucyB0aGF0IHdlIGNoYW5nZSBmcm9tIG9yIHRvIERTVCBvbiB0aGlzIGRheSBhbmQgdGhhdCdzIGdvaW5nIHRvIGNhdXNlIHByb2JsZW1zIHNvIHdlIGJ1bXAgdGhlIGRhdGVcclxuICAgIGlmIChzdGFydE9mVmlld0RheS5nZXRUaW1lem9uZU9mZnNldCgpICE9PSBlbmRPZlZpZXdEYXkuZ2V0VGltZXpvbmVPZmZzZXQoKSkge1xyXG4gICAgICAgIHN0YXJ0T2ZWaWV3RGF5ID0gYWRkRGF5cyhzdGFydE9mVmlld0RheSwgMSk7XHJcbiAgICAgICAgc3RhcnRPZlZpZXcgPSBhZGREYXlzKHN0YXJ0T2ZWaWV3LCAxKTtcclxuICAgICAgICBlbmRPZlZpZXcgPSBhZGREYXlzKGVuZE9mVmlldywgMSk7XHJcbiAgICAgICAgZGF0ZUFkanVzdG1lbnQgPSAoZDogRGF0ZSkgPT4gYWRkRGF5cyhkLCAtMSk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IEhPVVJTX0lOX0RBWTsgaSsrKSB7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IEhPVVJTX0lOX0RBWTsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qgc2VnbWVudHM6IFdlZWtWaWV3SG91clNlZ21lbnRbXSA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGo6IG51bWJlciA9IDA7IGogPCBob3VyU2VnbWVudHM7IGorKykge1xyXG4gICAgICAgICAgY29uc3QgZGF0ZTogRGF0ZSA9IGFkZE1pbnV0ZXMoXHJcbiAgICAgICAgICAgIGFkZEhvdXJzKHN0YXJ0T2ZWaWV3RGF5LCBpKSxcclxuICAgICAgICAgICAgaiAqIHNlZ21lbnREdXJhdGlvblxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIGlmIChkYXRlID49IHN0YXJ0T2ZWaWV3ICYmIGRhdGUgPCBlbmRPZlZpZXcpIHtcclxuICAgICAgICAgICAgc2VnbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgZGF0ZTogZGF0ZUFkanVzdG1lbnQoZGF0ZSksXHJcbiAgICAgICAgICAgICAgZGlzcGxheURhdGU6IGRhdGUsXHJcbiAgICAgICAgICAgICAgaXNTdGFydDogaiA9PT0gMFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlZ21lbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGhvdXJzLnB1c2goeyBzZWdtZW50cyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGhvdXJzO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEdldFNjaGVkdWxlclZpZXdBcmdzIHtcclxuICAgIGV2ZW50cz86IENhbGVuZGFyU2NoZWR1bGVyRXZlbnRbXTtcclxuICAgIHZpZXdEYXRlOiBEYXRlO1xyXG4gICAgdmlld0RheXM6IG51bWJlcjtcclxuICAgIGhvdXJTZWdtZW50czogMSB8IDIgfCA0IHwgNjtcclxuICAgIHdlZWtTdGFydHNPbjogbnVtYmVyO1xyXG4gICAgc3RhcnRzV2l0aFRvZGF5OiBib29sZWFuO1xyXG4gICAgZGF5U3RhcnQ6IFRpbWU7XHJcbiAgICBkYXlFbmQ6IFRpbWU7XHJcbiAgICB3ZWVrZW5kRGF5cz86IG51bWJlcltdO1xyXG4gICAgZXhjbHVkZWQ/OiBudW1iZXJbXTtcclxuICAgIGV2ZW50V2lkdGg6IG51bWJlcjtcclxuICAgIGhvdXJTZWdtZW50SGVpZ2h0OiBudW1iZXI7XHJcbiAgICBsb2dFbmFibGVkPzogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjaGVkdWxlclZpZXcoXHJcbiAgICBkYXRlQWRhcHRlcjogRGF0ZUFkYXB0ZXIsXHJcbiAgICB7XHJcbiAgICAgICAgZXZlbnRzID0gW10sXHJcbiAgICAgICAgdmlld0RhdGUsXHJcbiAgICAgICAgdmlld0RheXMsXHJcbiAgICAgICAgd2Vla1N0YXJ0c09uLFxyXG4gICAgICAgIHN0YXJ0c1dpdGhUb2RheSxcclxuICAgICAgICBleGNsdWRlZCA9IFtdLFxyXG4gICAgICAgIGhvdXJTZWdtZW50cyA9IERFRkFVTFRfSE9VUl9TRUdNRU5UUyxcclxuICAgICAgICBkYXlTdGFydCxcclxuICAgICAgICBkYXlFbmQsXHJcbiAgICAgICAgd2Vla2VuZERheXMgPSBERUZBVUxUX1dFRUtFTkRfREFZUyxcclxuICAgICAgICBob3VyU2VnbWVudEhlaWdodCA9IERFRkFVTFRfSE9VUl9TRUdNRU5UX0hFSUdIVF9QWCxcclxuICAgICAgICBldmVudFdpZHRoID0gREVGQVVMVF9FVkVOVF9XSURUSCxcclxuICAgICAgICBsb2dFbmFibGVkLFxyXG4gICAgfTogR2V0U2NoZWR1bGVyVmlld0FyZ3NcclxuKTogU2NoZWR1bGVyVmlldyB7XHJcbiAgICBpZiAoIWV2ZW50cykgeyBldmVudHMgPSBbXTsgfVxyXG5cclxuICAgIGNvbnN0IHsgYWRkRGF5cywgc3RhcnRPZkRheSwgZW5kT2ZEYXksIHN0YXJ0T2ZXZWVrLCBlbmRPZldlZWsgfSA9IGRhdGVBZGFwdGVyO1xyXG4gICAgY29uc3Qgc3RhcnRPZlZpZXdXZWVrOiBEYXRlID0gc3RhcnRzV2l0aFRvZGF5IHx8IHZpZXdEYXlzIDwgREFZU19JTl9XRUVLID8gc3RhcnRPZkRheSh2aWV3RGF0ZSkgOiBzdGFydE9mV2Vlayh2aWV3RGF0ZSwgeyB3ZWVrU3RhcnRzT246IHdlZWtTdGFydHNPbiB9KTtcclxuICAgIGNvbnN0IGVuZE9mVmlld1dlZWs6IERhdGUgPSBzdGFydHNXaXRoVG9kYXkgfHwgdmlld0RheXMgPCBEQVlTX0lOX1dFRUsgPyBhZGREYXlzKGVuZE9mRGF5KHZpZXdEYXRlKSwgdmlld0RheXMgLSAxKSA6IGVuZE9mV2Vlayh2aWV3RGF0ZSwgeyB3ZWVrU3RhcnRzT246IHdlZWtTdGFydHNPbiB9KTtcclxuXHJcbiAgICBjb25zdCBldmVudHNJbldlZWs6IENhbGVuZGFyU2NoZWR1bGVyRXZlbnRbXSA9IGdldEV2ZW50c0luUGVyaW9kKGRhdGVBZGFwdGVyLCB7XHJcbiAgICAgICAgZXZlbnRzOiBldmVudHMsXHJcbiAgICAgICAgcGVyaW9kU3RhcnQ6IHN0YXJ0T2ZWaWV3V2VlayxcclxuICAgICAgICBwZXJpb2RFbmQ6IGVuZE9mVmlld1dlZWtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGRheXM6IFNjaGVkdWxlclZpZXdEYXlbXSA9IGdldFNjaGVkdWxlclZpZXdEYXlzKGRhdGVBZGFwdGVyLCB7XHJcbiAgICAgICAgdmlld0RhdGU6IHZpZXdEYXRlLFxyXG4gICAgICAgIHZpZXdEYXlzOiB2aWV3RGF5cyxcclxuICAgICAgICB3ZWVrU3RhcnRzT246IHdlZWtTdGFydHNPbixcclxuICAgICAgICBzdGFydHNXaXRoVG9kYXk6IHN0YXJ0c1dpdGhUb2RheSxcclxuICAgICAgICBleGNsdWRlZDogZXhjbHVkZWQsXHJcbiAgICAgICAgd2Vla2VuZERheXM6IHdlZWtlbmREYXlzXHJcbiAgICB9KTtcclxuICAgIGRheXMuZm9yRWFjaCgoZGF5OiBTY2hlZHVsZXJWaWV3RGF5KSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnRPZlZpZXc6IERhdGUgPSBkYXRlQWRhcHRlci5zZXRNaW51dGVzKGRhdGVBZGFwdGVyLnNldEhvdXJzKGRhdGVBZGFwdGVyLnN0YXJ0T2ZEYXkoZGF5LmRhdGUpLCBkYXlTdGFydC5ob3VyKSwgZGF5U3RhcnQubWludXRlKTtcclxuICAgICAgICBjb25zdCBlbmRPZlZpZXc6IERhdGUgPSBkYXRlQWRhcHRlci5zZXRNaW51dGVzKGRhdGVBZGFwdGVyLnNldEhvdXJzKGRhdGVBZGFwdGVyLnN0YXJ0T2ZNaW51dGUoZGF0ZUFkYXB0ZXIuZW5kT2ZEYXkoZGF5LmRhdGUpKSwgZGF5RW5kLmhvdXIpLCBkYXlFbmQubWludXRlKTtcclxuICAgICAgICBjb25zdCBwcmV2aW91c0RheUV2ZW50czogU2NoZWR1bGVyVmlld0V2ZW50W10gPSBbXTtcclxuXHJcbiAgICAgICAgY29uc3QgZXZlbnRzSW5EYXk6IENhbGVuZGFyU2NoZWR1bGVyRXZlbnRbXSA9IGdldEV2ZW50c0luUGVyaW9kKGRhdGVBZGFwdGVyLCB7XHJcbiAgICAgICAgICAgIGV2ZW50czogZXZlbnRzSW5XZWVrLFxyXG4gICAgICAgICAgICBwZXJpb2RTdGFydDogc3RhcnRPZlZpZXcsXHJcbiAgICAgICAgICAgIHBlcmlvZEVuZDogZW5kT2ZWaWV3XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRheUV2ZW50cyA9IGV2ZW50c0luRGF5XHJcbiAgICAgICAgICAgIC5zb3J0KChldmVudEE6IENhbGVuZGFyU2NoZWR1bGVyRXZlbnQsIGV2ZW50QjogQ2FsZW5kYXJTY2hlZHVsZXJFdmVudCkgPT4gZXZlbnRBLnN0YXJ0LnZhbHVlT2YoKSAtIGV2ZW50Qi5zdGFydC52YWx1ZU9mKCkpXHJcbiAgICAgICAgICAgIC5tYXAoKGV2OiBDYWxlbmRhclNjaGVkdWxlckV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudFN0YXJ0OiBEYXRlID0gZXYuc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudEVuZDogRGF0ZSA9IGV2LmVuZCB8fCBldmVudFN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRzQmVmb3JlRGF5OiBib29sZWFuID0gZXZlbnRTdGFydCA8IHN0YXJ0T2ZWaWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5kc0FmdGVyRGF5OiBib29sZWFuID0gZGF0ZUFkYXB0ZXIuYWRkTWludXRlcyhldmVudEVuZCwgLTEpID4gZW5kT2ZWaWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaG91ckhlaWdodE1vZGlmaWVyOiBudW1iZXIgPSAoKGhvdXJTZWdtZW50cyAqIGhvdXJTZWdtZW50SGVpZ2h0KSArIDEpIC8gTUlOVVRFU19JTl9IT1VSOyAvLyArMSBmb3IgdGhlIDFweCBzZWdtZW50IGJvdHRvbSBib3JkZXJcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdG9wOiBudW1iZXIgPSAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50U3RhcnQgPiBzdGFydE9mVmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCArPSBkYXRlQWRhcHRlci5kaWZmZXJlbmNlSW5NaW51dGVzKGV2ZW50U3RhcnQsIHN0YXJ0T2ZWaWV3KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRvcCAqPSBob3VySGVpZ2h0TW9kaWZpZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlOiBEYXRlID0gc3RhcnRzQmVmb3JlRGF5ID8gc3RhcnRPZlZpZXcgOiBldmVudFN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5kRGF0ZTogRGF0ZSA9IGVuZHNBZnRlckRheSA/IGVuZE9mVmlldyA6IGV2ZW50RW5kO1xyXG4gICAgICAgICAgICAgICAgbGV0IGhlaWdodDogbnVtYmVyID0gZGF0ZUFkYXB0ZXIuZGlmZmVyZW5jZUluTWludXRlcyhlbmREYXRlLCBzdGFydERhdGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFldi5lbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBob3VyU2VnbWVudEhlaWdodDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ICo9IGhvdXJIZWlnaHRNb2RpZmllcjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBib3R0b206IG51bWJlciA9IHRvcCArIGhlaWdodDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG92ZXJsYXBwaW5nUHJldmlvdXNFdmVudHMgPSBnZXRPdmVyTGFwcGluZ0V2ZW50cyhcclxuICAgICAgICAgICAgICAgICAgICBldixcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0RheUV2ZW50cyxcclxuICAgICAgICAgICAgICAgICAgICB0b3AsXHJcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvZ0VuYWJsZWRcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGxlZnQ6IG51bWJlciA9IDA7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAob3ZlcmxhcHBpbmdQcmV2aW91c0V2ZW50cy5zb21lKHByZXZpb3VzRXZlbnQgPT4gcHJldmlvdXNFdmVudC5sZWZ0ID09PSBsZWZ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgKz0gZXZlbnRXaWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudDogU2NoZWR1bGVyVmlld0V2ZW50ID1cclxuICAgICAgICAgICAgICAgICAgICA8U2NoZWR1bGVyVmlld0V2ZW50PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGV2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBldmVudFdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydHNCZWZvcmVEYXk6IHN0YXJ0c0JlZm9yZURheSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kc0FmdGVyRGF5OiBlbmRzQWZ0ZXJEYXlcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHByZXZpb3VzRGF5RXZlbnRzLnB1c2goZXZlbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBldmVudDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldENvbHVtbkNvdW50KFxyXG4gICAgICAgICAgICBhbGxFdmVudHM6IFNjaGVkdWxlclZpZXdFdmVudFtdLFxyXG4gICAgICAgICAgICBwcmV2T3ZlcmxhcHBpbmdFdmVudHM6IFNjaGVkdWxlclZpZXdFdmVudFtdXHJcbiAgICAgICAgKTogbnVtYmVyIHtcclxuICAgICAgICAgICAgY29uc3QgY29sdW1uQ291bnQgPSBNYXRoLm1heChcclxuICAgICAgICAgICAgICAgIC4uLnByZXZPdmVybGFwcGluZ0V2ZW50cy5tYXAoKGV2OiBTY2hlZHVsZXJWaWV3RXZlbnQpID0+IGV2LmxlZnQgKyAxKVxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbmV4dE92ZXJsYXBwaW5nRXZlbnRzID0gYWxsRXZlbnRzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKChldjogU2NoZWR1bGVyVmlld0V2ZW50KSA9PiBldi5sZWZ0ID49IGNvbHVtbkNvdW50KVxyXG4gICAgICAgICAgICAgICAgLmZpbHRlcigoZXY6IFNjaGVkdWxlclZpZXdFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldE92ZXJMYXBwaW5nRXZlbnRzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2T3ZlcmxhcHBpbmdFdmVudHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi50b3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi50b3AgKyBldi5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFbmFibGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkubGVuZ3RoID4gMFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKG5leHRPdmVybGFwcGluZ0V2ZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q29sdW1uQ291bnQoYWxsRXZlbnRzLCBuZXh0T3ZlcmxhcHBpbmdFdmVudHMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbHVtbkNvdW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBtYXBwZWRFdmVudHMgPSBkYXlFdmVudHMubWFwKGV2ZW50ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29sdW1uQ291bnQgPSBnZXRDb2x1bW5Db3VudChcclxuICAgICAgICAgICAgICAgIGRheUV2ZW50cyxcclxuICAgICAgICAgICAgICAgIGdldE92ZXJMYXBwaW5nRXZlbnRzKFxyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIGRheUV2ZW50cyxcclxuICAgICAgICAgICAgICAgICAgICBldmVudC50b3AsXHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQudG9wICsgZXZlbnQuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIGxvZ0VuYWJsZWRcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gMTAwIC8gY29sdW1uQ291bnQ7XHJcbiAgICAgICAgICAgIHJldHVybiB7IC4uLmV2ZW50LCBsZWZ0OiBldmVudC5sZWZ0ICogd2lkdGgsIHdpZHRoIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRheS5ldmVudHMgPSBtYXBwZWRFdmVudHMubWFwKGV2ZW50ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgb3ZlckxhcHBpbmdFdmVudHMgPSBnZXRPdmVyTGFwcGluZ0V2ZW50cyhldmVudCxcclxuICAgICAgICAgICAgICBtYXBwZWRFdmVudHMuZmlsdGVyKG90aGVyRXZlbnQgPT4gb3RoZXJFdmVudC5sZWZ0ID4gZXZlbnQubGVmdCksXHJcbiAgICAgICAgICAgICAgZXZlbnQudG9wLFxyXG4gICAgICAgICAgICAgIGV2ZW50LnRvcCArIGV2ZW50LmhlaWdodCxcclxuICAgICAgICAgICAgICBsb2dFbmFibGVkXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZiAobG9nRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICAgICAgICAgICAgYERBWSBbJHttb21lbnQoZGF5LmRhdGUpLmZvcm1hdCgnZGRkZCBMJyl9XSBgICtcclxuICAgICAgICAgICAgICAgICAgICBgLSBFVkVOVCAke2V2ZW50LmV2ZW50LmlkfSBbJHttb21lbnQoZXZlbnQuZXZlbnQuc3RhcnQpLmZvcm1hdCgnZGRkZCBMLCBMVFMnKX0gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYC0gJHttb21lbnQoZXZlbnQuZXZlbnQuZW5kKS5mb3JtYXQoJ2RkZGQgTCwgTFRTJyl9XSBvdmVyTGFwcGluZ0V2ZW50cyAtPiBgLFxyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJMYXBwaW5nRXZlbnRzXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAob3ZlckxhcHBpbmdFdmVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAuLi5ldmVudCxcclxuICAgICAgICAgICAgICAgIHdpZHRoOlxyXG4gICAgICAgICAgICAgICAgICBNYXRoLm1pbihcclxuICAgICAgICAgICAgICAgICAgICAuLi5vdmVyTGFwcGluZ0V2ZW50cy5tYXAob3RoZXJFdmVudCA9PiBvdGhlckV2ZW50LmxlZnQpXHJcbiAgICAgICAgICAgICAgICAgICkgLSBldmVudC5sZWZ0XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZXZlbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRheS5ob3VycyA9IGdldFNjaGVkdWxlclZpZXdIb3VyR3JpZChkYXRlQWRhcHRlciwge1xyXG4gICAgICAgICAgICB2aWV3RGF0ZTogdmlld0RhdGUsXHJcbiAgICAgICAgICAgIGhvdXJTZWdtZW50czogaG91clNlZ21lbnRzLFxyXG4gICAgICAgICAgICBkYXlTdGFydDoge1xyXG4gICAgICAgICAgICAgICAgaG91cjogZGF5U3RhcnQuaG91cixcclxuICAgICAgICAgICAgICAgIG1pbnV0ZTogZGF5U3RhcnQubWludXRlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRheUVuZDoge1xyXG4gICAgICAgICAgICAgICAgaG91cjogZGF5RW5kLmhvdXIsXHJcbiAgICAgICAgICAgICAgICBtaW51dGU6IGRheUVuZC5taW51dGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLm1hcCgoaG91cjogV2Vla1ZpZXdIb3VyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGU6IERhdGUgPSBuZXcgRGF0ZShkYXkuZGF0ZS5nZXRGdWxsWWVhcigpLCBkYXkuZGF0ZS5nZXRNb250aCgpLCBkYXkuZGF0ZS5nZXREYXRlKCksIGhvdXIuc2VnbWVudHNbMF0uZGF0ZS5nZXRIb3VycygpKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0T2ZIb3VyOiBEYXRlID0gbmV3IERhdGUoZGF5LmRhdGUuZ2V0RnVsbFllYXIoKSwgZGF5LmRhdGUuZ2V0TW9udGgoKSwgZGF5LmRhdGUuZ2V0RGF0ZSgpLCBob3VyLnNlZ21lbnRzWzBdLmRhdGUuZ2V0SG91cnMoKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZE9mSG91cjogRGF0ZSA9IGRhdGVBZGFwdGVyLmFkZFNlY29uZHMoZGF0ZUFkYXB0ZXIuYWRkSG91cnMoc3RhcnRPZkhvdXIsIDEpLCAtMSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBldmVudHNJbkhvdXI6IFNjaGVkdWxlclZpZXdFdmVudFtdID0gZ2V0U2NoZWR1bGVyRXZlbnRzSW5QZXJpb2QoZGF0ZUFkYXB0ZXIsIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50czogZGF5LmV2ZW50cyxcclxuICAgICAgICAgICAgICAgIHBlcmlvZFN0YXJ0OiBzdGFydE9mSG91cixcclxuICAgICAgICAgICAgICAgIHBlcmlvZEVuZDogZW5kT2ZIb3VyXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2VnbWVudHM6IFNjaGVkdWxlclZpZXdIb3VyU2VnbWVudFtdID1cclxuICAgICAgICAgICAgICAgIGhvdXIuc2VnbWVudHMubWFwKChzZWdtZW50OiBXZWVrVmlld0hvdXJTZWdtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudC5kYXRlID0gZGF0ZUFkYXB0ZXIuc2V0RGF0ZShkYXRlQWRhcHRlci5zZXRNb250aChkYXRlQWRhcHRlci5zZXRZZWFyKHNlZ21lbnQuZGF0ZSwgZGF5LmRhdGUuZ2V0RnVsbFllYXIoKSksIGRheS5kYXRlLmdldE1vbnRoKCkpLCBkYXkuZGF0ZS5nZXREYXRlKCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydE9mU2VnbWVudDogRGF0ZSA9IHNlZ21lbnQuZGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRPZlNlZ21lbnQ6IERhdGUgPSBkYXRlQWRhcHRlci5hZGRTZWNvbmRzKGRhdGVBZGFwdGVyLmFkZE1pbnV0ZXMoc3RhcnRPZlNlZ21lbnQsIE1JTlVURVNfSU5fSE9VUiAvIGhvdXJTZWdtZW50cyksIC0xKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXZlbnRzSW5TZWdtZW50OiBTY2hlZHVsZXJWaWV3RXZlbnRbXSA9IGdldFNjaGVkdWxlckV2ZW50c0luUGVyaW9kKGRhdGVBZGFwdGVyLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czogZXZlbnRzSW5Ib3VyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJpb2RTdGFydDogc3RhcnRPZlNlZ21lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmlvZEVuZDogZW5kT2ZTZWdtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2dFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFNFR01FTlQgWyR7bW9tZW50KHN0YXJ0T2ZTZWdtZW50KS5mb3JtYXQoJ2RkZGQgTCwgTFRTJyl9IC0gJHttb21lbnQoZW5kT2ZTZWdtZW50KS5mb3JtYXQoJ2RkZGQgTCwgTFRTJyl9XSBFVkVOVFMgLT4gYCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50c0luU2VnbWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxTY2hlZHVsZXJWaWV3SG91clNlZ21lbnQ+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50OiBzZWdtZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZShzZWdtZW50LmRhdGUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudHM6IGV2ZW50c0luU2VnbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiA8U2NoZWR1bGVyVmlld0hvdXI+e1xyXG4gICAgICAgICAgICAgICAgaG91cjogaG91cixcclxuICAgICAgICAgICAgICAgIGRhdGU6IGRhdGUsXHJcbiAgICAgICAgICAgICAgICBldmVudHM6IGV2ZW50c0luSG91cixcclxuICAgICAgICAgICAgICAgIHNlZ21lbnRzOiBzZWdtZW50c1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIDxTY2hlZHVsZXJWaWV3PntcclxuICAgICAgICBkYXlzOiBkYXlzLFxyXG4gICAgICAgIHBlcmlvZDogPFNjaGVkdWxlclZpZXdQZXJpb2Q+e1xyXG4gICAgICAgICAgICBldmVudHM6IGV2ZW50c0luV2VlayxcclxuICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0T2ZWaWV3V2VlayxcclxuICAgICAgICAgICAgZW5kOiBlbmRPZlZpZXdXZWVrXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBHZXRTY2hlZHVsZXJWaWV3RGF5c0FyZ3Mge1xyXG4gICAgdmlld0RhdGU6IERhdGU7XHJcbiAgICB2aWV3RGF5czogbnVtYmVyO1xyXG4gICAgd2Vla1N0YXJ0c09uOiBudW1iZXI7XHJcbiAgICBzdGFydHNXaXRoVG9kYXk6IGJvb2xlYW47XHJcbiAgICBleGNsdWRlZD86IG51bWJlcltdO1xyXG4gICAgd2Vla2VuZERheXM/OiBudW1iZXJbXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjaGVkdWxlclZpZXdEYXlzKFxyXG4gICAgZGF0ZUFkYXB0ZXI6IERhdGVBZGFwdGVyLFxyXG4gICAge1xyXG4gICAgICAgIHZpZXdEYXRlLFxyXG4gICAgICAgIHZpZXdEYXlzLFxyXG4gICAgICAgIHdlZWtTdGFydHNPbixcclxuICAgICAgICBzdGFydHNXaXRoVG9kYXksXHJcbiAgICAgICAgZXhjbHVkZWQgPSBbXSxcclxuICAgICAgICB3ZWVrZW5kRGF5cyA9IERFRkFVTFRfV0VFS0VORF9EQVlTXHJcbiAgICB9OiBHZXRTY2hlZHVsZXJWaWV3RGF5c0FyZ3NcclxuKTogU2NoZWR1bGVyVmlld0RheVtdIHtcclxuICAgIGNvbnN0IHN0YXJ0ID0gc3RhcnRzV2l0aFRvZGF5IHx8IHZpZXdEYXlzIDwgREFZU19JTl9XRUVLXHJcbiAgICAgICAgPyBuZXcgRGF0ZSh2aWV3RGF0ZSlcclxuICAgICAgICA6IGRhdGVBZGFwdGVyLnN0YXJ0T2ZXZWVrKHZpZXdEYXRlLCB7IHdlZWtTdGFydHNPbjogd2Vla1N0YXJ0c09uIH0pO1xyXG4gICAgY29uc3QgZGF5czogU2NoZWR1bGVyVmlld0RheVtdID0gW107XHJcbiAgICBjb25zdCBsb29wID0gKGk6IG51bWJlcikgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBkYXRlQWRhcHRlci5hZGREYXlzKHN0YXJ0LCBpKTtcclxuICAgICAgICBpZiAoIWV4Y2x1ZGVkLnNvbWUoKGU6IG51bWJlcikgPT4gZGF0ZS5nZXREYXkoKSA9PT0gZSkpIHtcclxuICAgICAgICAgICAgZGF5cy5wdXNoKGdldFNjaGVkdWxlckRheShkYXRlQWRhcHRlciwgeyBkYXRlLCB3ZWVrZW5kRGF5cyB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmlld0RheXM7IGkrKykge1xyXG4gICAgICAgIGxvb3AoaSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGF5cztcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U2NoZWR1bGVyRGF5KGRhdGVBZGFwdGVyOiBEYXRlQWRhcHRlciwgYXJnczogeyBkYXRlOiBEYXRlLCB3ZWVrZW5kRGF5czogbnVtYmVyW10gfSk6IFNjaGVkdWxlclZpZXdEYXkge1xyXG4gICAgY29uc3QgZGF0ZTogRGF0ZSA9IGFyZ3MuZGF0ZTtcclxuICAgIGNvbnN0IHRvZGF5OiBEYXRlID0gZGF0ZUFkYXB0ZXIuc3RhcnRPZkRheShuZXcgRGF0ZSgpKTtcclxuXHJcbiAgICByZXR1cm4gPFNjaGVkdWxlclZpZXdEYXk+e1xyXG4gICAgICAgIGRhdGU6IGRhdGUsXHJcbiAgICAgICAgaXNQYXN0OiBkYXRlIDwgdG9kYXksXHJcbiAgICAgICAgaXNUb2RheTogZGF0ZUFkYXB0ZXIuaXNTYW1lRGF5KGRhdGUsIHRvZGF5KSxcclxuICAgICAgICBpc0Z1dHVyZTogZGF0ZSA+PSBkYXRlQWRhcHRlci5hZGREYXlzKHRvZGF5LCAxKSxcclxuICAgICAgICBpc1dlZWtlbmQ6IGFyZ3Mud2Vla2VuZERheXMuaW5kZXhPZihkYXRlQWRhcHRlci5nZXREYXkoZGF0ZSkpID4gLTEsXHJcbiAgICAgICAgaW5Nb250aDogZGF0ZUFkYXB0ZXIuaXNTYW1lTW9udGgoZGF0ZSwgdG9kYXkpLFxyXG4gICAgICAgIGhvdXJzOiBbXVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBHZXRFdmVudHNJblBlcmlvZEFyZ3Mge1xyXG4gICAgZXZlbnRzOiBDYWxlbmRhclNjaGVkdWxlckV2ZW50W107XHJcbiAgICBwZXJpb2RTdGFydDogRGF0ZTtcclxuICAgIHBlcmlvZEVuZDogRGF0ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0RXZlbnRzSW5QZXJpb2QoXHJcbiAgICBkYXRlQWRhcHRlcjogRGF0ZUFkYXB0ZXIsXHJcbiAgICB7XHJcbiAgICAgICAgZXZlbnRzLFxyXG4gICAgICAgIHBlcmlvZFN0YXJ0LFxyXG4gICAgICAgIHBlcmlvZEVuZFxyXG4gICAgfTogR2V0RXZlbnRzSW5QZXJpb2RBcmdzXHJcbik6IENhbGVuZGFyU2NoZWR1bGVyRXZlbnRbXSB7XHJcbiAgICByZXR1cm4gZXZlbnRzLmZpbHRlcigoZXZlbnQpID0+IGlzRXZlbnRJblBlcmlvZChkYXRlQWRhcHRlciwgeyBldmVudDogZXZlbnQsIHBlcmlvZFN0YXJ0OiBwZXJpb2RTdGFydCwgcGVyaW9kRW5kOiBwZXJpb2RFbmQgfSkpO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEdldFNjaGVkdWxlckV2ZW50c0luUGVyaW9kQXJncyB7XHJcbiAgICBldmVudHM6IFNjaGVkdWxlclZpZXdFdmVudFtdO1xyXG4gICAgcGVyaW9kU3RhcnQ6IERhdGU7XHJcbiAgICBwZXJpb2RFbmQ6IERhdGU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFNjaGVkdWxlckV2ZW50c0luUGVyaW9kKFxyXG4gICAgZGF0ZUFkYXB0ZXI6IERhdGVBZGFwdGVyLFxyXG4gICAge1xyXG4gICAgICAgIGV2ZW50cyxcclxuICAgICAgICBwZXJpb2RTdGFydCxcclxuICAgICAgICBwZXJpb2RFbmRcclxuICAgIH06IEdldFNjaGVkdWxlckV2ZW50c0luUGVyaW9kQXJnc1xyXG4pOiBTY2hlZHVsZXJWaWV3RXZlbnRbXSB7XHJcbiAgICByZXR1cm4gZXZlbnRzLmZpbHRlcigoZXZlbnQpID0+IGlzRXZlbnRJblBlcmlvZChkYXRlQWRhcHRlciwgeyBldmVudDogZXZlbnQuZXZlbnQsIHBlcmlvZFN0YXJ0OiBwZXJpb2RTdGFydCwgcGVyaW9kRW5kOiBwZXJpb2RFbmQgfSkpO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgSXNFdmVudEluUGVyaW9kQXJncyB7XHJcbiAgICBldmVudDogQ2FsZW5kYXJTY2hlZHVsZXJFdmVudDtcclxuICAgIHBlcmlvZFN0YXJ0OiBEYXRlO1xyXG4gICAgcGVyaW9kRW5kOiBEYXRlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0V2ZW50SW5QZXJpb2QoZGF0ZUFkYXB0ZXI6IERhdGVBZGFwdGVyLCB7IGV2ZW50LCBwZXJpb2RTdGFydCwgcGVyaW9kRW5kfTogSXNFdmVudEluUGVyaW9kQXJncyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgeyBpc1NhbWVTZWNvbmQsIGFkZFNlY29uZHMgfSA9IGRhdGVBZGFwdGVyO1xyXG4gICAgY29uc3QgZXZlbnRTdGFydDogRGF0ZSA9IGV2ZW50LnN0YXJ0O1xyXG4gICAgY29uc3QgZXZlbnRFbmQ6IERhdGUgPSBldmVudC5lbmQgfHwgZXZlbnQuc3RhcnQ7XHJcblxyXG4gICAgaWYgKGV2ZW50U3RhcnQgPiBwZXJpb2RTdGFydCAmJiBldmVudFN0YXJ0IDwgcGVyaW9kRW5kKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGV2ZW50RW5kID4gcGVyaW9kU3RhcnQgJiYgZXZlbnRFbmQgPCBwZXJpb2RFbmQpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZXZlbnRTdGFydCA8IHBlcmlvZFN0YXJ0ICYmIGV2ZW50RW5kID4gcGVyaW9kRW5kKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGlzU2FtZVNlY29uZChldmVudFN0YXJ0LCBwZXJpb2RTdGFydCkgfHwgaXNTYW1lU2Vjb25kKGV2ZW50U3RhcnQsIHBlcmlvZEVuZCkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaXNTYW1lU2Vjb25kKGFkZFNlY29uZHMoZXZlbnRFbmQsIC0xKSwgcGVyaW9kU3RhcnQpIHx8IGlzU2FtZVNlY29uZChhZGRTZWNvbmRzKGV2ZW50RW5kLCAtMSksIHBlcmlvZEVuZCkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBnZXRPdmVyTGFwcGluZ0V2ZW50cyhldmVudDogYW55LypTY2hlZHVsZXJWaWV3RXZlbnQgfCBDYWxlbmRhclNjaGVkdWxlckV2ZW50Ki8sIGV2ZW50czogU2NoZWR1bGVyVmlld0V2ZW50W10sIHRvcDogbnVtYmVyLCBib3R0b206IG51bWJlciwgbG9nRW5hYmxlZDogYm9vbGVhbiA9IGZhbHNlKTogU2NoZWR1bGVyVmlld0V2ZW50W10ge1xyXG4gICAgcmV0dXJuIGV2ZW50cy5maWx0ZXIoKHByZXZpb3VzRXZlbnQ6IFNjaGVkdWxlclZpZXdFdmVudCkgPT4ge1xyXG4gICAgICAgIHRvcCA9IE1hdGgucm91bmQodG9wKTtcclxuICAgICAgICBib3R0b20gPSBNYXRoLnJvdW5kKGJvdHRvbSk7XHJcbiAgICAgICAgY29uc3QgcHJldmlvdXNFdmVudFRvcDogbnVtYmVyID0gTWF0aC5mbG9vcihwcmV2aW91c0V2ZW50LnRvcCk7XHJcbiAgICAgICAgY29uc3QgcHJldmlvdXNFdmVudEJvdHRvbTogbnVtYmVyID0gTWF0aC5mbG9vcihwcmV2aW91c0V2ZW50LnRvcCArIHByZXZpb3VzRXZlbnQuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgaWYgKHRvcCA8IHByZXZpb3VzRXZlbnRCb3R0b20gJiYgcHJldmlvdXNFdmVudEJvdHRvbSA8IGJvdHRvbSkge1xyXG4gICAgICAgICAgICBpZiAobG9nRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tnZXRPdmVyTGFwcGluZ0V2ZW50c10gLSBFVkVOVCAnICsgKGV2ZW50LmV2ZW50Py5pZCB8fCBldmVudC5pZCkgKyAnIC0+IHRvcDogJyArIHRvcCArICcgLSBib3R0b206ICcgKyBib3R0b20gKyAnIHwgUFJFVklPVVMgRVZFTlQgJyArIHByZXZpb3VzRXZlbnQuZXZlbnQuaWRcclxuICAgICAgICAgICAgICAgICAgICArICcgLT4gcHJldmlvdXNFdmVudFRvcDogJyArIHByZXZpb3VzRXZlbnRUb3AgKyAnIC0gcHJldmlvdXNFdmVudEJvdHRvbTogJyArIHByZXZpb3VzRXZlbnRCb3R0b20gKyAnIC0+IHRvcCA8IHByZXZpb3VzRXZlbnRCb3R0b20gJiYgcHJldmlvdXNFdmVudEJvdHRvbSA8IGJvdHRvbScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodG9wIDwgcHJldmlvdXNFdmVudFRvcCAmJiBwcmV2aW91c0V2ZW50VG9wIDwgYm90dG9tKSB7XHJcbiAgICAgICAgICAgIGlmIChsb2dFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW2dldE92ZXJMYXBwaW5nRXZlbnRzXSAtIEVWRU5UICcgKyAoZXZlbnQuZXZlbnQ/LmlkIHx8IGV2ZW50LmlkKSArICcgLT4gdG9wOiAnICsgdG9wICsgJyAtIGJvdHRvbTogJyArIGJvdHRvbSArICcgfCBQUkVWSU9VUyBFVkVOVCAnICsgcHJldmlvdXNFdmVudC5ldmVudC5pZFxyXG4gICAgICAgICAgICAgICAgICAgICsgJyAtPiBwcmV2aW91c0V2ZW50VG9wOiAnICsgcHJldmlvdXNFdmVudFRvcCArICcgLSBwcmV2aW91c0V2ZW50Qm90dG9tOiAnICsgcHJldmlvdXNFdmVudEJvdHRvbSArICcgLT4gdG9wIDwgcHJldmlvdXNFdmVudFRvcCAmJiBwcmV2aW91c0V2ZW50VG9wIDwgYm90dG9tJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwcmV2aW91c0V2ZW50VG9wIDw9IHRvcCAmJiBib3R0b20gPD0gcHJldmlvdXNFdmVudEJvdHRvbSkge1xyXG4gICAgICAgICAgICBpZiAobG9nRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tnZXRPdmVyTGFwcGluZ0V2ZW50c10gLSBFVkVOVCAnICsgKGV2ZW50LmV2ZW50Py5pZCB8fCBldmVudC5pZCkgKyAnIC0+IHRvcDogJyArIHRvcCArICcgLSBib3R0b206ICcgKyBib3R0b20gKyAnIHwgUFJFVklPVVMgRVZFTlQgJyArIHByZXZpb3VzRXZlbnQuZXZlbnQuaWRcclxuICAgICAgICAgICAgICAgICAgICArICcgLT4gcHJldmlvdXNFdmVudFRvcDogJyArIHByZXZpb3VzRXZlbnRUb3AgKyAnIC0gcHJldmlvdXNFdmVudEJvdHRvbTogJyArIHByZXZpb3VzRXZlbnRCb3R0b20gKyAnIC0+IHByZXZpb3VzRXZlbnRUb3AgPD0gdG9wICYmIGJvdHRvbSA8PSBwcmV2aW91c0V2ZW50Qm90dG9tJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHNhbml0aXNlSG91cnMoaG91cnM6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICByZXR1cm4gTWF0aC5tYXgoTWF0aC5taW4oMjMsIGhvdXJzKSwgMCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhbml0aXNlTWludXRlcyhtaW51dGVzOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIE1hdGgubWF4KE1hdGgubWluKDU5LCBtaW51dGVzKSwgMCk7XHJcbn1cclxuIl19